# Windows Hello 画面读取工具

这是一个用于读取和显示Windows Hello摄像头（特别是红外摄像头）画面的工具，基于PyQt5和OpenCV开发。

(部分系统存在无法读取红外视频画面的问题，待后期查证后修复)

## 功能特点

- **多种摄像头模式支持**：
  - 无红外补光模式（普通摄像头）
  - 有红外补光模式（红外摄像头）
  - 实时画面模式（普通摄像头）

- **智能摄像头检测**：
  - 自动枚举系统中的摄像头设备
  - 区分普通摄像头和红外摄像头
  - 特别优化了Windows Hello摄像头的检测
  - 支持多方法检测，确保摄像头被正确识别

- **友好的用户界面**：
  - 简洁直观的操作界面
  - 实时预览摄像头画面
  - 自动调整画面大小，保持显示比例

- **高兼容性**：
  - 支持多种摄像头API
  - 提供备用检测方法，应对不同设备环境
  - 完善的错误处理和用户提示

## 安装要求

### 系统要求
- Windows 10/11操作系统
- 支持摄像头的硬件环境
- 如果需要使用Windows Hello功能，需要设备配备红外摄像头

### 依赖库
- Python 3.6+
- opencv-python
- PyQt5
- pywin32

## 安装步骤

1. 确保已安装Python 3.6或更高版本

2. 安装所需依赖库：
   ```
   pip install opencv-python PyQt5 pywin32
   ```

3. 下载本项目代码

## 使用方法

1. 运行程序：
   ```
   python demo.py
   ```

2. 在界面中：
   - 从"功能选择"下拉菜单中选择需要的模式
   - 系统会自动列出可用的对应类型摄像头
   - 选择摄像头后，点击"开始预览"按钮
   - 点击"停止预览"按钮结束预览

3. 特别说明：
   - 如果系统中有Windows Hello红外摄像头，程序会尝试自动识别
   - 如果自动识别失败，可以尝试"尝试红外摄像头"系列选项
   - 对于某些特殊设备，可能需要尝试不同的摄像头索引

## 故障排除

### 常见问题

1. **无法检测到摄像头**
   - 确保摄像头已正确连接并在设备管理器中可见
   - 尝试重新启动程序或电脑
   - 检查摄像头权限设置

2. **打开摄像头失败**
   - 确保没有其他程序正在使用该摄像头
   - 尝试选择不同的摄像头选项
   - 检查摄像头驱动是否已正确安装

3. **画面显示异常**
   - 尝试调整显示窗口大小
   - 切换不同的功能模式

## 注意事项

- 使用过程中，程序会请求摄像头访问权限
- 红外摄像头可能需要特定的硬件支持才能正常工作
- 不同品牌和型号的摄像头可能会有不同的兼容性表现

## 技术说明

程序使用多种方法检测摄像头：
1. 通过WMI查询系统设备信息
2. 直接使用OpenCV尝试连接不同索引的设备
3. 提供手动编号的摄像头选项作为备选

这种多方法检测确保了对各种摄像头设备（特别是Windows Hello相关设备）的广泛兼容性。

## 许可证

本项目采用MIT许可证。

## 联系方式

如有问题或建议，请随时提出Issue或Pull Request。

邮箱：dezanhuang@gmail.com 或 1912828464@qq.com

e-mail：dezanhuang@gmail.com or 1912828464@qq.com